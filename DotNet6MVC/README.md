# DotNet6 Quickstart

The goal of this project is not to provide a template for you to clone.  
Instead, this guide will tell you how to expand on the built in templates that the `dotnet new` command provides.

This ensures that new projects will benefit from changes to the builtin templates, while also increasing understanding of changes that we suggest making.

This guide expects you to be using Visual Studio Code with the C# extension installed.

## Walthrough

This guide will focus on MVC as it the standard used by the majority of TC development teams.

### Initializing the project

Run this command in an empty folder where you want your project to be located.  
The name of this folder will determine the project name and namespace used by the autogenerated files.

```powershell
dotnet new mvc --auth SingleOrg
```

### Local auth config

This expects you to have already acquired an app registration in the Azure Active Directory.

From the autogenerated `appsettings.json`, replace the `AzureAd` block with the following:

```json
  "AzureAd": {
    "Instance": "https://login.microsoftonline.com/",
    "Domain": "tc.gc.ca",
    "CallbackPath": "/signin-oidc"
  },
```

Replace the following values with those associated with your app registration and run these commands to set the secrets needed to run.

```powershell
dotnet user-secrets set AzureAd:ClientId "11111111-1111-1111-11111111111111111"
dotnet user-secrets set AzureAd:TenantId "22222222-2222-2222-2222-222222222222"
```

This will allow the app to work without storing these values in your repo.  
See also: [should I consider my Azure tenant id a secret?](https://security.stackexchange.com/questions/238696/should-i-consider-my-azure-tenant-id-as-a-secret)

### Azure auth config

You will need to add the reply url to your app registration in the Azure portal to ensure you don't get errors while logging in.  

_The port number can be omitted._

![](./images/addreplyurl.png)

### Test run

At this point, you can test the app by running

```powershell
dotnet run
```

Alternatively, the C# extension will prompt you to add build configs which allows you to run using your VSCode shortcuts.

![](./images/buildconfig.png)


You should see your email in the top right if the signin is working.

![](./images/authtestgood.png)

If the reply urls are misconfigured, you will receive an error like this:

![](./images/badreplyurl.png)

### Gitignore

The build process generates some files we don't care about.  
Rather than creating a `.gitignore` file manually, you can just use the following command:

```powershell
dotnet new gitignore
```
